terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Succesuful_Attacks"=sum(success)) %>%
rename(Year=iyear)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Succesuful_Attacks"=sum(success)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(stat = "identity")
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(stat = "identity")
terrorism_arms_plot
arms_data_analysis <- arms_import_wr %>% select(1:21) %>% gather(key = Year, value=value,-Country) %>% filter(endsWith(as.character(Country),suffix = "*")) %>%
filter(endsWith(as.character(Country),")*")) %>% group_by(Year) %>% summarize("sum_of_arms_imports_to_insurgents"=sum(value,na.rm = TRUE))
arms_data_analysis$Year <- as.character(arms_data_analysis$Year)
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Succesuful_Attacks"=sum(success)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(stat = "identity") + scale_y_continuous()
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents))
terrorism_arms_plot
arms_data_analysis <- arms_import_wr %>% select(1:21) %>% gather(key = Year, value=value,-Country) %>% filter(endsWith(as.character(Country),suffix = "*")) %>%
filter(endsWith(as.character(Country),")*")) %>% group_by(Year) %>% summarize("sum_of_arms_imports_to_insurgents"=sum(value,na.rm = TRUE))
arms_data_analysis$Year <- as.character(arms_data_analysis$Year)
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Succesful_Attacks"=sum(success)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(stat = "identity")
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(stat = "identity") + scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
#geom_bar(stat = "identity") +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data,aes(x=as.numeric(Year),y=Num_Succesful_Attacks)) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity")
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity") +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
scale_y_continuous(sec.axis = sec_axis(~./20))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents)) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity",color="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Succesful_Attacks),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))
terrorism_arms_plot
arms_data_analysis <- arms_import_wr %>% select(1:21) %>% gather(key = Year, value=value,-Country) %>% filter(endsWith(as.character(Country),suffix = "*")) %>%
filter(endsWith(as.character(Country),")*")) %>% group_by(Year) %>% summarize("sum_of_arms_imports_to_insurgents"=sum(value,na.rm = TRUE))
arms_data_analysis$Year <- as.character(arms_data_analysis$Year)
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Casualties_Terrorism"=sum(nkill)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) + labs
arms_data_analysis <- arms_import_wr %>% select(1:21) %>% gather(key = Year, value=value,-Country) %>% filter(endsWith(as.character(Country),suffix = "*")) %>%
filter(endsWith(as.character(Country),")*")) %>% group_by(Year) %>% summarize("sum_of_arms_imports_to_insurgents"=sum(value,na.rm = TRUE))
arms_data_analysis$Year <- as.character(arms_data_analysis$Year)
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Casualties_Terrorism"=sum(nkill)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))# + labs
terrorism_arms_plot
terrorism_data_analysis <- terrorism_df %>% group_by(iyear) %>% summarise("Num_Casualties_Terrorism"=sum(nkill,na.rm = TRUE)) %>%
rename(Year=iyear)
terrorism_data_analysis$Year <- as.character(terrorism_data_analysis$Year)
terrorism_arms_data <- left_join(arms_data_analysis,terrorism_data_analysis,"Year") %>% filter(Year != "2019")
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents)))# + labs
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents,name="Value of arms Sales to non-state/paramilitary($Millions)"))) +
labs(title = "Arms Sales to non-State forces and Casualties from Terrorsim",x="Year",y="Number of Casualties from Terror Attacks")
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents),name="Value of arms Sales to non-state/paramilitary($Millions)")) +
labs(title = "Arms Sales to non-State forces and Casualties from Terrorsim",x="Year",y="Number of Casualties from Terror Attacks")
terrorism_arms_plot
terrorism_arms_plot
terrorism_arms_plot <- ggplot(data = terrorism_arms_data) +
geom_bar(mapping = aes(x=as.numeric(Year),y=Num_Casualties_Terrorism),stat = "identity",fill="red") +
geom_point(data = terrorism_arms_data,aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
geom_line(data =terrorism_arms_data, aes(x=as.numeric(Year),y=sum_of_arms_imports_to_insurgents*max(terrorism_arms_data$sum_of_arms_imports_to_insurgents))) +
scale_y_continuous(sec.axis = sec_axis(~./max(terrorism_arms_data$sum_of_arms_imports_to_insurgents),name="Value of arms Sales($Millions)")) +
labs(title = "Arms Sales to non-State forces and Casualties from Terrorsim",x="Year",y="Number of Casualties from Terror Attacks")
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt)
View(attack_data)
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>% summarise("Biological"= sum(weaptype1_txt="Biological"))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>% summarise("Biological"= sum(as.character(weaptype1_txt)="Biological"))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>% summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological"))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>% summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= sum(attack_data[2:13]))
View(attack_data)
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>% group_by(gname) %>%
mutate("sum_attacks"= sum(attack_data[2:13]))
View(attack_data)
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(2:13))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(terrorism_df[,2:13]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(terrorism_df[2:13,]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(as.numeric(terrorism_df[2:13,])))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowsum(.))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowsum([2:13,]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowsum([2:13,]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowsum(.[,c(2:13)]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowsum(.[c(2:13),]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)]))
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks)
View(attack_data)
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks) %>% head(10)
gathered_attack_data <- attack_data %>% gather(key = attack_type,value=value,-gname)
View(gathered_attack_data)
gathered_attack_data <- attack_data %>% select(-sum_attacks) %>% gather(key = attack_type,value=value,-gname)
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=gname,y=value,fill=attack_type),position = "stack",stat = "identity")
attack_plot
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks) %>% head(11) %>% filter(gname = "Unknown")
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks) %>% head(11) %>% filter(gname == "Unknown")
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks) %>% head(11) %>% filter(gname != "Unknown")
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=gname,y=value,fill=attack_type),position = "stack",stat = "identity")
attack_plot
gathered_attack_data <- attack_data %>% select(-sum_attacks) %>% gather(key = attack_type,value=value,-gname)
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=gname,y=value,fill=attack_type),position = "stack",stat = "identity")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",color="attack type")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",legend="attack type")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_color_brewer(palette = "Set1")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_color_brewer(palette = "Set1")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set1")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Paired")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set3")
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set3") + theme(axis.text.x = element_text(size = 6,angle = 45))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set3") + theme(axis.text.x = element_text(size = 6,angle = 30))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set3") + theme(axis.text.x = element_text(size = 6,angle = 20))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette = "Set3") + theme(axis.text.x = element_text(size = 6,angle = 15))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_discrete()
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_discrete() + theme(axis.text.x = element_text(size = 6,angle = 15))
attack_plot
View(terrorism_df)
attack_data <- terrorism_df %>% select(gname,weaptype1_txt,targtype1_txt) %>% group_by(gname) %>%
summarise("Biological"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE),"Chemical"= sum(as.character(weaptype1_txt)=="Chemical",na.rm = TRUE),
"Explosives"= sum(as.character(weaptype1_txt)=="Explosives",na.rm = TRUE),"Fake Weapons"= sum(as.character(weaptype1_txt)=="Fake Weapons",na.rm = TRUE),
"Firearms"= sum(as.character(weaptype1_txt)=="Firearms",na.rm = TRUE),"Incendiary"= sum(as.character(weaptype1_txt)=="Incendiary",na.rm = TRUE),
"Melee"= sum(as.character(weaptype1_txt)=="Melee",na.rm = TRUE),"Other"= sum(as.character(weaptype1_txt)=="Other",na.rm = TRUE),
"Radiological"= sum(as.character(weaptype1_txt)=="Radiological",na.rm = TRUE),"Sabotage Equipment"= sum(as.character(weaptype1_txt)=="Sabotage Equipment",na.rm = TRUE),
"Unknown"= sum(as.character(weaptype1_txt)=="Unknown",na.rm = TRUE),"Vehicle-borne explosive"= sum(as.character(weaptype1_txt)=="Biological",na.rm = TRUE)) %>%
mutate("sum_attacks"= rowSums(.[,c(2:13)])) %>% arrange(-sum_attacks) %>% head(11) %>% filter(gname != "Unknown")
gathered_attack_data <- attack_data %>% select(-sum_attacks) %>% gather(key = attack_type,value=value,-gname)
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_discrete() + theme(axis.text.x = element_text(size = 6,angle = 15))
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror groups Differ in their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_discrete() + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_discrete() + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer("Paired") + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(pallete="Paired") + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Paired") + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Set3") + theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
#scale_fill_brewer(palette ="Set3") +
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Paired") +
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Pal9") +
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Set3") +
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
#scale_fill_brewer(palette ="Set3") +
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
attack_plot <- ggplot(data = gathered_attack_data) +
geom_bar(mapping = aes(x=reorder(gname,value),y=value,fill=attack_type),position = "stack",stat = "identity") +
labs(title = "Do Terror Groups Differ in Their Strategies?",y="Number of Attacks",x="Group Name",fill="attack type") +
scale_fill_brewer(palette ="Set3") +
theme(axis.text.x = element_text(size = 7,angle = 10))
theme(axis.text.x = element_text(size = 7,angle = 10))
attack_plot
terrorism_arms_plot
terrorism_data_analysis
attack_data_sample <- attack_data %>% head(5) %>% select(1:5,)
View(attack_data_sample)
attack_data_sample <- attack_data %>% head(5) %>% select(1:5,)
attack_data_sample <- attack_data %>% head(5) %>% select(1:5)
attack_data[5,6]
attack_plot
attack_plot
attack_plot
attack_plot
attack_plot
attack_plot
shiny::runApp('C:/Users/mwdel/book-exercises/chapter-19-exercises/exercise-3')
diamonds_sample <- sample_n(diamonds, 1000)
range(diamonds_sample$price)
library("dplyr")
price_range <- range(diamonds_sample$price)
features <- colnames(diamonds)
features
runApp('C:/Users/mwdel/book-exercises/chapter-19-exercises/exercise-3')
runApp('C:/Users/mwdel/book-exercises/chapter-19-exercises/exercise-3')
runApp('C:/Users/mwdel/book-exercises/chapter-19-exercises/exercise-3')
runApp('C:/Users/mwdel/book-exercises/chapter-19-exercises/exercise-3')
